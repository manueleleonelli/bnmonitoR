<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how bnmonitor implements sensitivity analysis for discrete BNs
">
<title>Sensitivity Analysis in Discrete BNs â€¢ bnmonitor</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity Analysis in Discrete BNs">
<meta property="og:description" content="Learn how bnmonitor implements sensitivity analysis for discrete BNs
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bnmonitor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Robustness.html">Robustness to Data</a>
    <a class="dropdown-item" href="../articles/Sensitivity.html">Sensitivity Analysis in Discrete BNs</a>
    <a class="dropdown-item" href="../articles/Sensitivity2.html">Sensitivity Analysis in Gaussian BNs</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/manueleleonelli/bnmonitor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Sensitivity Analysis in Discrete BNs</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/manueleleonelli/bnmonitor/blob/HEAD/vignettes/Sensitivity.Rmd" class="external-link"><code>vignettes/Sensitivity.Rmd</code></a></small>
      <div class="d-none name"><code>Sensitivity.Rmd</code></div>
    </div>

    
    
<p>The functionalities of <code>bnmonitor</code> for sensitivity analysis in Discrete Bayesian Networks are illustrated using the <code>fire_alarm</code> network bundled within the package representing a simple alarm system for fire accidents.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.bnlearn.com/" class="external-link">bnlearn</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://manueleleonelli.github.io/bnmonitor/">bnmonitor</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/graphviz.plot.html" class="external-link">graphviz.plot</a></span><span class="op">(</span><span class="va">fire_alarm</span><span class="op">)</span></code></pre></div>
<p><img src="Sensitivity_files/figure-html/unnamed-chunk-2-1.png" width="700" style="display: block; margin: auto;"></p>
<p>The network consists of 6 nodes (<code>Fire</code>, <code>Smoke</code>, <code>Tampering</code>, <code>Alarm</code>, <code>Leaving</code> and <code>Report</code>) of either two or three levels.</p>
<div class="section level3">
<h3 id="covariation-schemes">Covariation schemes<a class="anchor" aria-label="anchor" href="#covariation-schemes"></a>
</h3>
<p>The aim of a sensitivity analysis is to assess how parameter changes affect output probabilities of interest. When one parameter changes than others need to be adjusted and this can be done in many ways, including <code>proportional</code>, <code>uniform</code> and <code>order-preserving</code> schemes. Suppose we vary the probability that <code>Alarm = FALSE</code> given that <code>Fire = TRUE</code> and <code>Tampering = FALSE</code> from 0.01 to 0.1. The resulting probabilities from the proportional covariation scheme can be computed as follows.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/covariation.html">proportional_covar</a></span><span class="op">(</span>bnfit <span class="op">=</span> <span class="va">fire_alarm</span>, node <span class="op">=</span> <span class="st">"Alarm"</span>, value_node <span class="op">=</span> <span class="st">"FALSE"</span>, value_parents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span>,<span class="st">"FALSE"</span><span class="op">)</span>, new_value <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">$</span><span class="va">Alarm</span><span class="op">$</span><span class="va">prob</span>
<span class="co">#&gt; , , Tampering = TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              Fire</span>
<span class="co">#&gt; Alarm               TRUE      FALSE</span>
<span class="co">#&gt;   TRUE        0.60000000 0.65000000</span>
<span class="co">#&gt;   MALFUNCTION 0.20000000 0.20000000</span>
<span class="co">#&gt;   FALSE       0.20000000 0.15000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , Tampering = FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              Fire</span>
<span class="co">#&gt; Alarm               TRUE      FALSE</span>
<span class="co">#&gt;   TRUE        0.83636364 0.00010000</span>
<span class="co">#&gt;   MALFUNCTION 0.06363636 0.65000000</span>
<span class="co">#&gt;   FALSE       0.10000000 0.34990000</span></code></pre></div>
<p>The functions <code>uniform_covar</code> and <code>orderp_covar</code> have the same inputs and return the BN where probabilities are updated using uniform and order-preserving covariation, respectively.</p>
</div>
<div class="section level3">
<h3 id="sensitivity-functions">Sensitivity functions<a class="anchor" aria-label="anchor" href="#sensitivity-functions"></a>
</h3>
<p>Suppose we are interested in the probability that <code>Report = TRUE</code> and how this varies with respect to the probability that <code>Alarm = FALSE</code> conditional on <code>Fire = TRUE</code> and <code>Tampering = FALSE</code>. This can be computed with the function <code>sensitivity</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="va">sens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensitivity.html">sensitivity</a></span><span class="op">(</span>bnfit <span class="op">=</span> <span class="va">fire_alarm</span>, interest_node <span class="op">=</span> <span class="st">"Report"</span>, interest_node_value <span class="op">=</span>  <span class="st">"TRUE"</span> , node <span class="op">=</span> <span class="st">"Alarm"</span> , value_node <span class="op">=</span> <span class="st">"FALSE"</span>, value_parents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span>,<span class="st">"FALSE"</span><span class="op">)</span>, new_value <span class="op">=</span> <span class="st">"all"</span>, covariation <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'gRbase'</span>
<span class="co">#&gt; The following objects are masked from 'package:bnlearn':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     ancestors, children, nodes, parents</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">sens</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<p><img src="Sensitivity_files/figure-html/unnamed-chunk-4-1.png" width="700" style="display: block; margin: auto;"></p>
<p>For all covariation schemes as the conditional probability of <code>Alarm = FALSE</code> increases, the probability of <code>Report = TRUE</code> decreases. The uniform covariation scheme is reported in red, the proportional in green and the order-preserving in blue.</p>
<p>The function sensitivity also allows for conditional probabilities of interest, not only marginals, which can be set by the options <code>evidence_nodes</code> and <code>evidence_states</code>.</p>
<p>For such changes in the probability distribution of a BN, we can compute the distance between the original and the varied networks using the Chan-Darwiche distance (<code>CD</code>) and the Kullback-Leibler divergence (<code>KL</code>). As an example consider <code>Alarm = MALFUNCTIOn</code> conditional on <code>Fire = TRUE</code> and <code>Tampering = FALSE</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cd_distance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CD.html">CD</a></span><span class="op">(</span><span class="va">fire_alarm</span>, node <span class="op">=</span> <span class="st">"Alarm"</span>, value_node <span class="op">=</span> <span class="st">"MALFUNCTION"</span>, value_parents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span>,<span class="st">"FALSE"</span><span class="op">)</span>, new_value <span class="op">=</span> <span class="st">"all"</span>, covariation <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> 
<span class="va">kl_divergence</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/KL.html">KL</a></span><span class="op">(</span><span class="va">fire_alarm</span>, node <span class="op">=</span> <span class="st">"Alarm"</span>, value_node <span class="op">=</span> <span class="st">"MALFUNCTION"</span>, value_parents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span>,<span class="st">"FALSE"</span><span class="op">)</span>, new_value <span class="op">=</span> <span class="st">"all"</span>, covariation <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> 
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">cd_distance</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<p><img src="Sensitivity_files/figure-html/unnamed-chunk-5-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">kl_divergence</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<p><img src="Sensitivity_files/figure-html/unnamed-chunk-5-2.png" width="700" style="display: block; margin: auto;"></p>
<p>As expected proportional covariation has the smallest distance/divergence of all covariation schemes.</p>
</div>
<div class="section level3">
<h3 id="sensitivity-queries">Sensitivity queries<a class="anchor" aria-label="anchor" href="#sensitivity-queries"></a>
</h3>
<p>Another task in sensitivity analysis is to identify parameter changes that meet a specific constraint. As an example suppose we want the probability <code>Report = TRUE</code> to be equal to 0.4. Which parameters could we change to obtain such a probability? The answer can be obtained using the function <code>sensquery</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sensquery.html">sensquery</a></span><span class="op">(</span>bnfit <span class="op">=</span> <span class="va">fire_alarm</span>, interest_node <span class="op">=</span> <span class="st">"Report"</span>, interest_node_value <span class="op">=</span> <span class="st">"TRUE"</span>, new_value <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span>
<span class="co">#&gt;        Node Value node Value parents Original value Suggested change</span>
<span class="co">#&gt; 1   Leaving       TRUE   MALFUNCTION         0.7300        0.7983961</span>
<span class="co">#&gt; 2    Report       TRUE          TRUE         0.7500        0.8164951</span>
<span class="co">#&gt; 3 Tampering       TRUE                       0.0200        0.2018769</span>
<span class="co">#&gt; 4      Fire       TRUE                       0.0100        0.1252059</span>
<span class="co">#&gt; 5     Alarm       TRUE   FALSE,FALSE         0.0001        0.1106591</span>
<span class="co">#&gt;   CD distance</span>
<span class="co">#&gt; 1   0.3816771</span>
<span class="co">#&gt; 2   0.3941673</span>
<span class="co">#&gt; 3   2.5172158</span>
<span class="co">#&gt; 4   2.6510913</span>
<span class="co">#&gt; 5   7.1262142</span></code></pre></div>
<p>There are five parameter changes that would lead to a probability of <code>Report = TRUE</code> of 0.4. These are ordered by the value of the CD distance between the original and the new network, from smallest to largest.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Manuele Leonelli, Ramsiya Ramanathan, Rachel Wilkerson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
